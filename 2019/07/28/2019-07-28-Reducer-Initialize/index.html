<!DOCTYPE html><html lang="ko"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>리듀서 초기화 | The Pragmatic Programmer</title><link rel="stylesheet" href="/libs/spoqa-han-sans-kr/css/SpoqaHanSans-kr.css"><link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/css/highlights/dracula.css"><link rel="canonical" href="https://eclatant.io/2019/07/28/2019-07-28-Reducer-Initialize/"/>
<meta name="description" content="리덕스는 UI -&amp;gt; Action Creator -&amp;gt; Action -&amp;gt; Store -&amp;gt; Reducer -&amp;gt; UI 라는 흐름을 따른다 그런데 매번 하나의 흐름을 만들어낼 때마다 위 과정에 해당하는 것들을 하나씩 더 만들어주기…">
<meta name="keywords" content="Dev">
<meta property="og:type" content="article">
<meta property="og:title" content="리듀서 초기화">
<meta property="og:url" content="https://eclatant.io/2019/07/28/2019-07-28-Reducer-Initialize/">
<meta property="og:site_name" content="The Pragmatic Programmer">
<meta property="og:description" content="리덕스는 UI -&amp;gt; Action Creator -&amp;gt; Action -&amp;gt; Store -&amp;gt; Reducer -&amp;gt; UI 라는 흐름을 따른다 그런데 매번 하나의 흐름을 만들어낼 때마다 위 과정에 해당하는 것들을 하나씩 더 만들어주기…">
<meta property="og:locale" content="ko">
<meta property="og:image" content="https://eclatant.io/images/hollywood.jpg">
<meta property="og:updated_time" content="2019-07-28T14:55:50.640Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="리듀서 초기화">
<meta name="twitter:description" content="리덕스는 UI -&amp;gt; Action Creator -&amp;gt; Action -&amp;gt; Store -&amp;gt; Reducer -&amp;gt; UI 라는 흐름을 따른다 그런데 매번 하나의 흐름을 만들어낼 때마다 위 과정에 해당하는 것들을 하나씩 더 만들어주기…">
<meta name="twitter:image" content="https://eclatant.io/images/hollywood.jpg"><meta property="article:author" content="Jeewhan"><meta property="twitter:label1" content="Published at"><meta property="twitter:data1" content="2019-07-28 00:00:00"><meta property="twitter:label2" content="Written by"><meta property="twitter:data2" content="Jeewhan"><link rel="icon" href="/images/hollywood.png"><link rel="alternate" href="/atom.xml" type="application/atom+xml" title="The Pragmatic Programmer"></head><body itemscope itemtype="https://schema.org/WebPage"><nav class="menu" id="menu"><div class="menu-inner"><div class="menu__left-area"><div class="menu__item"><a class="menu__item__link menu__item__link--brand" href="/" title="Home" rel="home"><img class="menu__item__link--brand__image" src="/images/hollywood.png" alt="The Pragmatic Programmer"><span class="menu__item__link--brand__label">The Pragmatic Programmer</span></a></div></div><div class="menu__right-area"><div class="menu__item"><a class="menu__item__link" href="/">Home</a></div><div class="menu__item"><a class="menu__item__link" href="/about">About</a></div><div class="menu__item"><a class="menu__item__link" href="/archives">Archives</a></div></div></div></nav><div class="page-background"></div><div class="content-container"><div class="content-outer"><div class="content-inner" itemscope itemtype="https://schema.org/Blog"><article class="article" id="article" itemscope itemtype="https://schema.org/BlogPosting"><h1 class="article__title" itemprop="headline">리듀서 초기화</h1><div class="article__meta"><time class="article__meta__time" datetime="2019-07-27T15:00:00.000Z" itemprop="datePublished">2019-07-28 00:00:00</time><div class="article__meta__categories"><a class="article__meta__categories__item" href="/categories/Dev/">Dev</a></div></div><hr><div class="article__contents"><p>리덕스는 UI -&gt; Action Creator -&gt; Action -&gt; Store -&gt; Reducer -&gt; UI 라는 흐름을 따른다</p>
<p>그런데 매번 하나의 흐름을 만들어낼 때마다 위 과정에 해당하는 것들을 하나씩 더 만들어주기 마련이고, 그 흐름은 대체로 애플리케이션 전체에서 1~2곳 정도 쓰이는 경우가 많다</p>
<p>그래서 Ducks 패턴 등이 나왔다고 생각한다</p>
<p>Ducks 패턴은 첫 문장에서 설명한 흐름을 여러 파일에 나누어 각 단계별로 모은 파일로 관리하는 것이 아니라, 도메인(?)을 기준으로 파일을 생성하여 관리하는 방식으로 응집성(?)을 높이고자 했다고 이해했다</p>
<p>위와 비슷하게 모든 리듀서와 관련해서 반복되는 상황을 찾아 해결하려고 했던 나름의 시도를 적어보고자 한다</p>
<p>여러 리듀서들에서 모두 사용할법한 액션은 무엇일까? 바로 초기화이다</p>
<p>지금의 프로젝트를 맡게 되었을 때 하나의 액션 크리에이터 내에서 여러 번의 dispatch가 이루어지고, 그것이 곧 여러 차례의 리렌더로 이어지는 것을 보고 해결하고자 방법을 찾고 있을 때, 지인 분께서 어차피 액션은 모든 리듀서에 전파되기에 서로 다른 리듀서를 업데이트하고 싶다면 그것을 하나의 액션으로 묶으면 되지 않겠냐는 말씀을 하셨다</p>
<p>생각하지 못 했던 방법이었고, 실제로 실험해보았을 때도 기대대로 잘 동작하였다</p>
<p>머릿속에서 추상적으로 이해하였을 때는 하나의 액션이 하나의 리듀서에만 특정지어져야 할 것 같았지만 실제로는 그렇지 않았다</p>
<p>위 조언에서 힌트를 얻어서 만든 액션 크리에이터가 아래와 같다</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> initialize = <span class="function">(<span class="params">payload: object</span>) =&gt;</span> (&#123; <span class="keyword">type</span>: INITIALIZE, payload &#125;);</span><br></pre></td></tr></table></figure>
<p>위 액션이 여러 리듀서에 존재한다면 각 리듀서에서는 자신과 관련된 액션인지를 어떻게 구분할 것인가?</p>
<p>그 코드는 아래와 같다</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> initialState: IEngagementState = &#123;</span><br><span class="line">  bookmarks: [],</span><br><span class="line">  carts: [],</span><br><span class="line">  coordies: [],</span><br><span class="line">  pins: [],</span><br><span class="line">  recents: []</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">engagement</span>(<span class="params">state = initialState, &#123; <span class="keyword">type</span>, payload &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> produce(state, <span class="function"><span class="params">draft</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> (<span class="keyword">type</span>) &#123;</span><br><span class="line">      <span class="keyword">case</span> INITIALIZE:</span><br><span class="line">        <span class="built_in">Object</span>.keys(initialState).forEach(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (payload[key]) &#123;</span><br><span class="line">            draft[key] = engagementViewModelCreator[key](payload[key]);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>즉 내가 초기화하고자 하는 데이터들을 리듀서의 키에 매핑해서 전달하는 형식이다</p>
<p>그렇다면 위 코드에서 <code>engagementViewModelCreator</code>는 무엇인가?</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> cartsViewModelCreator = (options: IOption[]): ICartViewModel[] =&gt; options.map(createCart);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> engagementViewModelCreator = &#123;</span><br><span class="line">  carts: cartsViewModelCreator,</span><br><span class="line">  recents: recentsViewModelCreator,</span><br><span class="line">  pins: pinsViewModelCreator,</span><br><span class="line">  bookmarks: bookmarksViewModelCreator,</span><br><span class="line">  coordies: coordiesViewModelCreator</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>위와 같은 방식으로 서버로부터 받아온 데이터를 받아 initialize 액션을 통해 전달하면 해당 리듀서에서 key를 기준으로 인식하여 약속된 ViewModelCreator로 전달하여 원하는 형태의 데이터로 가공하여 스토어에 데이터를 담아서 UI로 전달하는 형태이다</p>
<p>ViewModelCreator는 아직 그 이름에 비해서 역할이 대단하진 못하다</p>
<p>프로젝트 상황상 axios interceptor에서 snake -&gt; camel을 처리할 수 없어서 새롭게 만들어가는 부분에만 우선 적용하고 있기에 snake -&gt; camel은 ViewModelCreator에서 담당하고 있다</p>
<p>즉 아직은 PreProcessor 단계에 머물러있는 상태이다</p>
<p>또한 개인적인 생각으로 프론트엔드에서 섬세하게 신경써서 코딩하지 않으면 모든 처리가 컴포넌트에 집중되고 그것이 좋지 않다고 생각해서, 최대한 UI 컴포넌트 이전 레이어들을 쌓아 UI 컴포넌트에는 최대한 UI와 관련된 사항들이나 해당 컴포넌트에서만 쓰일 로직들을 보관하는 방향으로 진행하고 있다</p>
<p>그런 측면에서 사소하게는 toLocaleString 부터 computed한 계산값들은 이미 ViewModelCreator 단계에서 최대한 처리해주고자 한다</p>
<p>다른 사람이 위와 같은 처리를 하는 것을 보고 만든 것은 아니어서 스스로는 항상 불안하게 생각하는 구조지만, 지금 현재는 나름대로 잘 쓰고 있어서 주변 지인들로부터 피드백을 받아 좀 더 나은 방향으로 발전시켜나가고 싶다</p>
</div><div class="article__tags"><a class="article__tags__item" href="/tags/Dev/">Dev</a></div><div class="article__author" itemscope itemprop="author" itemtype="https://schema.org/Person"><img class="article__author__image" src="/images/avatar.jpg" alt="Jeewhan"><a class="article__author__link" title="About Jeewhan" rel="author">Jeewhan</a><p class="article__author__desc">Dev Blog</p><div class="article__author__socials"><a class="article__author__socials__item" href="/atom.xml" title="rss" target="_blank"><i class="fa fa-rss"></i></a></div><meta itemprop="name" content="Jeewhan"></div><div class="sharer" id="sharer"><div class="sharer-inner"><div class="sharer__right"><button class="sharer__item" id="sharer-facebook"><i class="fa fa-facebook-official"></i></button><button class="sharer__item" id="sharer-twitter"><i class="fa fa-twitter"></i></button><button class="sharer__item" id="sharer-pinterest"><i class="fa fa-pinterest"></i></button><button class="sharer__item" id="sharer-pocket"><i class="fa fa-get-pocket"></i></button></div></div></div><!-- Disqus Code--><!-- Meta Tags for Structured Data--><meta itemprop="dateModified" content="2019-07-28T14:55:50.640Z"><meta itemprop="articleBody" content="리덕스는 UI -&amp;gt; Action Creator -&amp;gt; Action -&amp;gt; Store -&amp;gt; Reducer -&amp;gt; UI 라는 흐름을 따른다
그런데 매번 하나의 흐름을 만들어낼 때마다 위 과정에 해당하는 것들을 하나씩 더 만들어주기 마련이고, 그 흐름은 대체로 애플리케이션 전체에서 1~2곳 정도 쓰이는 경우가 많다
그래서 Ducks..."><meta itemprop="url" content="https://eclatant.io/2019/07/28/2019-07-28-Reducer-Initialize/"><meta itemprop="mainEntityOfPage" content="https://eclatant.io/2019/07/28/2019-07-28-Reducer-Initialize/"><div itemscope itemtype="https://schema.org/Organization" itemprop="publisher"><meta itemprop="name" content="The Pragmatic Programmer"><div itemscope itemprop="logo" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://eclatant.io/images/hollywood.png"></div></div><div itemscope itemtype="https://schema.org/ImageObject" itemprop="image"><meta itemprop="contentUrl" content="https://eclatant.io/images/hollywood.jpg"><meta itemprop="url" content="https://eclatant.io/images/hollywood.jpg"><meta itemprop="width" content="800"><meta itemprop="height" content="800"></div></article><section class="related-posts"><h3>Related posts</h3><div class="related-posts__item__wrapper"><a class="related-posts__item" href="/2018/11/18/2018-11-18-WeeklyHistory/"><div class="related-posts__item__background" style="background-image:url('/images/hollywood.jpg');"></div><div class="related-posts__item__overlay"></div><span class="related-posts__item__title">이번 주에 접했던 것들 #1 : 18-11-18</span></a></div><div class="related-posts__item__wrapper"><a class="related-posts__item" href="/2018/11/11/2018-11-11-WeeklyHistory/"><div class="related-posts__item__background" style="background-image:url('/images/hollywood.jpg');"></div><div class="related-posts__item__overlay"></div><span class="related-posts__item__title">이번 주에 접했던 것들 #0 : 18-11-11</span></a></div><div class="related-posts__item__wrapper"><a class="related-posts__item" href="/2018/11/25/2018-11-25-WeeklyHistory/"><div class="related-posts__item__background" style="background-image:url('/images/hollywood.jpg');"></div><div class="related-posts__item__overlay"></div><span class="related-posts__item__title">이번 주에 접했던 것들 #2 : 18-11-25</span></a></div></section></div></div></div><footer id="footer"><div class="widgets"><div class="widgets-inner"><!-- Jade doesn't support dynamic inclusion with `each`.--><!-- So, I just hard coded the file names that will be included.--><div class="widgets__item"><h3 class="widgets__item__heading">Recent posts</h3><ul class="recent-posts"><li class="recent-posts__item"><a href="/2019/07/28/2019-07-28-Reducer-Initialize/">리듀서 초기화</a></li><li class="recent-posts__item"><a href="/2019/07/21/2019-07-21-Pair-1/">짝 작업 몰입 워크샵 (1)</a></li><li class="recent-posts__item"><a href="/2019/07/14/2019-07-14-Object-1/">오브젝트 1장</a></li><li class="recent-posts__item"><a href="/2019/07/07/2019-07-07-Promise/">하반기 다짐</a></li><li class="recent-posts__item"><a href="/2019/06/30/2019-06-30-Cart/">장바구니 만들기</a></li></ul></div><div class="widgets__item"><h3 class="widgets__item__heading">Tag cloud</h3><div class="tag-cloud"><a href="/tags/Algorithm/" style="font-size: 1.13rem;">Algorithm</a> <a href="/tags/Article/" style="font-size: 0.75rem;">Article</a> <a href="/tags/CtCI/" style="font-size: 0.75rem;">CtCI</a> <a href="/tags/Dev/" style="font-size: 1.5rem;">Dev</a> <a href="/tags/Education/" style="font-size: 0.75rem;">Education</a> <a href="/tags/English/" style="font-size: 0.75rem;">English</a> <a href="/tags/Essay/" style="font-size: 1.13rem;">Essay</a> <a href="/tags/FP/" style="font-size: 0.75rem;">FP</a> <a href="/tags/JS/" style="font-size: 1.13rem;">JS</a> <a href="/tags/Python/" style="font-size: 0.75rem;">Python</a> <a href="/tags/Rails/" style="font-size: 0.75rem;">Rails</a> <a href="/tags/React/" style="font-size: 0.94rem;">React</a> <a href="/tags/Ruby/" style="font-size: 1.31rem;">Ruby</a> <a href="/tags/TDD/" style="font-size: 0.75rem;">TDD</a> <a href="/tags/node/" style="font-size: 0.75rem;">node</a></div></div><div class="widgets__item"><h3 class="widgets__item__heading">Categories</h3><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Algorithm/">Algorithm</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Article/">Article</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/CodeSquad/">CodeSquad</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/CtCI/">CtCI</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Dev/">Dev</a><span class="category-list-count">15</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Education/">Education</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/English/">English</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Essay/">Essay</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JS/">JS</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Rails/">Rails</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/React/">React</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Ruby/">Ruby</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/node/">node</a><span class="category-list-count">1</span></li></ul></div></div></div><p class="copyright"><small>© 2019 Jeewhan<br>Powered by <a href="https://hexo.io" rel="external" target="_blank">Hexo</a>, Theme by <a href="https://github.com/hyunseob" rel="external" target="_blank">HyunSeob</a></small></p></footer><!--[if lt IE 10]><script src="/js/classList.min.js"></script><![endif]--><script src="/js/index.min.js"></script></body></html>
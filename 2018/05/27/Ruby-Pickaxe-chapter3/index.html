<!DOCTYPE html><html lang="ko"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>루비 곡괭이 3장 클래스, 객체, 변수 | The Pragmatic Programmer</title><link rel="stylesheet" href="/libs/spoqa-han-sans-kr/css/SpoqaHanSans-kr.css"><link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/css/highlights/dracula.css"><link rel="canonical" href="https://eclatant.io/2018/05/27/Ruby-Pickaxe-chapter3/"/>
<meta name="description" content="루비에서 다루는 모든 것은 객체이며, 클래스에서 직간접적으로 생성할 수 있다, 이번 장에서는 클래스를 만들고 다루는 법을 살펴본다 객체지향 시스템을 설계할 때 항상 제일 먼저 해야 하는 일은 다루고자 하는 대상들의 특징을 파악하는 것이다일반적으로…">
<meta name="keywords" content="Ruby">
<meta property="og:type" content="article">
<meta property="og:title" content="루비 곡괭이 3장 클래스, 객체, 변수">
<meta property="og:url" content="https://eclatant.io/2018/05/27/Ruby-Pickaxe-chapter3/">
<meta property="og:site_name" content="The Pragmatic Programmer">
<meta property="og:description" content="루비에서 다루는 모든 것은 객체이며, 클래스에서 직간접적으로 생성할 수 있다, 이번 장에서는 클래스를 만들고 다루는 법을 살펴본다 객체지향 시스템을 설계할 때 항상 제일 먼저 해야 하는 일은 다루고자 하는 대상들의 특징을 파악하는 것이다일반적으로…">
<meta property="og:locale" content="ko">
<meta property="og:image" content="https://eclatant.io/images/hollywood.jpg">
<meta property="og:updated_time" content="2018-06-02T01:11:48.775Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="루비 곡괭이 3장 클래스, 객체, 변수">
<meta name="twitter:description" content="루비에서 다루는 모든 것은 객체이며, 클래스에서 직간접적으로 생성할 수 있다, 이번 장에서는 클래스를 만들고 다루는 법을 살펴본다 객체지향 시스템을 설계할 때 항상 제일 먼저 해야 하는 일은 다루고자 하는 대상들의 특징을 파악하는 것이다일반적으로…">
<meta name="twitter:image" content="https://eclatant.io/images/hollywood.jpg"><meta property="article:author" content="Jeewhan"><meta property="twitter:label1" content="Published at"><meta property="twitter:data1" content="2018-05-27 00:00:00"><meta property="twitter:label2" content="Written by"><meta property="twitter:data2" content="Jeewhan"><link rel="icon" href="/images/hollywood.png"><link rel="alternate" href="/atom.xml" type="application/atom+xml" title="The Pragmatic Programmer"></head><body itemscope itemtype="https://schema.org/WebPage"><nav class="menu" id="menu"><div class="menu-inner"><div class="menu__left-area"><div class="menu__item"><a class="menu__item__link menu__item__link--brand" href="/" title="Home" rel="home"><img class="menu__item__link--brand__image" src="/images/hollywood.png" alt="The Pragmatic Programmer"><span class="menu__item__link--brand__label">The Pragmatic Programmer</span></a></div></div><div class="menu__right-area"><div class="menu__item"><a class="menu__item__link" href="/">Home</a></div><div class="menu__item"><a class="menu__item__link" href="/about">About</a></div><div class="menu__item"><a class="menu__item__link" href="/archives">Archives</a></div></div></div></nav><div class="page-background"></div><div class="content-container"><div class="content-outer"><div class="content-inner" itemscope itemtype="https://schema.org/Blog"><article class="article" id="article" itemscope itemtype="https://schema.org/BlogPosting"><h1 class="article__title" itemprop="headline">루비 곡괭이 3장 클래스, 객체, 변수</h1><div class="article__meta"><time class="article__meta__time" datetime="2018-05-26T15:00:00.000Z" itemprop="datePublished">2018-05-27 00:00:00</time><div class="article__meta__categories"><a class="article__meta__categories__item" href="/categories/Ruby/">Ruby</a></div></div><hr><div class="article__contents"><p>루비에서 다루는 모든 것은 객체이며, 클래스에서 직간접적으로 생성할 수 있다, 이번 장에서는 클래스를 만들고 다루는 법을 살펴본다</p>
<p>객체지향 시스템을 설계할 때 항상 제일 먼저 해야 하는 일은 다루고자 하는 대상들의 특징을 파악하는 것이다<br>일반적으로 다루고자 하는 대상들이 속하는 형식(type)은 클래스로 만들어진다, 그리고 각 대상은 이 클래스의 인스턴스가 된다</p>
<p>헌책방 관리를 위한 클래스를 만들어보자</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInStock</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(isbn, price)</span></span></span><br><span class="line">    @isbn = isbn</span><br><span class="line">    @price = Float(price)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">to_s</span></span></span><br><span class="line">    <span class="string">"ISBN: <span class="subst">#&#123;@isbn&#125;</span>, price: <span class="subst">#&#123;@price&#125;</span>"</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">b1 = BookInStock.new(<span class="string">'isbn1'</span>, <span class="number">3</span>)</span><br><span class="line">p b1 <span class="comment"># #&lt;BookInStock:0x00007f93fa9acf78 <span class="doctag">@isbn</span>="isbn1", <span class="doctag">@price</span>=3.0&gt;</span></span><br><span class="line">puts b1 <span class="comment"># ISBN: isbn1, price: 3.0</span></span><br><span class="line"></span><br><span class="line">b2 = BookInStock.new(<span class="string">'isbn2'</span>, <span class="number">3.14</span>)</span><br><span class="line">p b2 <span class="comment"># #&lt;BookInStock:0x00007f93fa997c90 <span class="doctag">@isbn</span>="isbn2", <span class="doctag">@price</span>=3.14&gt;</span></span><br><span class="line">puts b2 <span class="comment"># ISBN: isbn2, price: 3.14</span></span><br><span class="line"></span><br><span class="line">b3 = BookInStock.new(<span class="string">'isbn3'</span>, <span class="string">'5.67'</span>)</span><br><span class="line">p b3 <span class="comment"># #&lt;BookInStock:0x00007f93fa986738 <span class="doctag">@isbn</span>="isbn3", <span class="doctag">@price</span>=5.67&gt;</span></span><br><span class="line">puts b3 <span class="comment"># ISBN: isbn3, price: 5.67</span></span><br></pre></td></tr></table></figure>
<p>initialize 메서드는 객체의 환경을 초기화해서 이를 사용 가능한 상태로 만들어두어야 한다, 그러면 다른 메서드들에서는 이 상태를 사용한다</p>
<p>매개변수는 지역변수와 동일한 스코프이므로 initialize 메서드가 끝나면 함께 사라져버린다, 따라서 필요한 정보를 인스턴스 변수에 저장해야 한다 (@를 붙이면 인스턴스 변수가 된다)</p>
<p>p는 객체의 상태를 보여주고 자기 자신을 리턴하는 것에 비해 puts는 단순히 프로그램의 표준 출력에 문자열을 출력하고 nil을 반환할 뿐이다, puts에 객체를 인자로 넘겨주면 가장 간단한 방법으로 처리한다, <code>#&lt;객체의 이름:16진수로 된 고유 번호&gt;</code> 하지만 만약 클래스에 to_s가 정의되어 있다면 해당 결과를 출력한다</p>
<p>인스턴스 변수는 각 인스턴스에 저장되며, 해당 클래스에 정의되는 모든 인스턴스 메소드에서 참조 가능하다</p>
<hr>
<h2 id="3-1-객체와-속성"><a href="#3-1-객체와-속성" class="headerlink" title="3.1 객체와 속성"></a>3.1 객체와 속성</h2><p>위의 코드대로라면 객체의 내부 상태는 각 객체 내부에 저장된 정보로 다른 객체에서는 접근할 수 없다, 일반적으로 객체의 일관성을 지키기 위한 책임이 하나의 객체에 전적으로 맡겨진다는 것은 좋은 의미이다</p>
<p>그러나 객체의 정보가 완전히 감춰진다면 아무 의미도 없으므로, 일반적으로 객체 외부에서 객체 상태에 접근하거나 조작하는 메서드를 별도로 정의해서 외부에서도 객체 상태에 접근 가능하도록 만들어 준다, 이렇게 노출되는 내부 부분을 객체의 속성, attribute라고 한다</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInStock</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(isbn, price)</span></span></span><br><span class="line">    @isbn = isbn</span><br><span class="line">    @price = Float(price)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">isbn</span></span></span><br><span class="line">    @isbn</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">price</span></span></span><br><span class="line">    @price</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">book = BookInStock.new(<span class="string">"isbn1"</span>, <span class="number">12.34</span>)</span><br><span class="line">puts <span class="string">"ISBN = <span class="subst">#&#123;book.isbn&#125;</span>"</span> <span class="comment"># ISBN = isbn1</span></span><br><span class="line">puts <span class="string">"Price = <span class="subst">#&#123;book.price&#125;</span>"</span> <span class="comment"># Price = 12.34</span></span><br></pre></td></tr></table></figure>
<p>위와 같은 접근자 메서드는 매우 자주 사용되므로 루비에서는 편의 메서드를 제공한다 (루비는 메서드 마지막에 평가된 표현식의 평가 결과를 반환한다, 여기서는 인스턴스 변수의 값을 반환할 것이다)</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInStock</span></span></span><br><span class="line">  <span class="keyword">attr_reader</span> <span class="symbol">:isbn</span>, <span class="symbol">:price</span></span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(isbn, price)</span></span></span><br><span class="line">    @isbn = isbn</span><br><span class="line">    @price = Float(price)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">book = BookInStock.new(<span class="string">"isbn1"</span>, <span class="number">12.34</span>)</span><br><span class="line">puts <span class="string">"ISBN = <span class="subst">#&#123;book.isbn&#125;</span>"</span> <span class="comment"># ISBN = isbn1</span></span><br><span class="line">puts <span class="string">"Price = <span class="subst">#&#123;book.price&#125;</span>"</span> <span class="comment"># Price = 12.34</span></span><br></pre></td></tr></table></figure>
<p>attr_reader는 접근자 메서드를 대신 생성해준다</p>
<p>:isbn 에서 심볼 표현을 볼 수 있는데, 심볼은 이름을 참조할 때 사용하기 좋다, :이 있다면 isbn이라는 이름을, :이 없다면 변수의 값 자체를 의미한다, :isbn에 대응하는 접근자 메서드에서 반환할 인스턴스 변수는 당연히 @isbn이다</p>
<p>루비에서 인스턴스 변수와 접근자 메서드는 분리되어 있다, attr_reader는 인스턴스 변수를 쉽게 선언할 수 있도록 만들어진 선언문이 아니다</p>
<h4 id="쓰기-가능한-속성"><a href="#쓰기-가능한-속성" class="headerlink" title="쓰기 가능한 속성"></a>쓰기 가능한 속성</h4><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInStock</span></span></span><br><span class="line">  <span class="keyword">attr_reader</span> <span class="symbol">:isbn</span>, <span class="symbol">:price</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(isbn, price)</span></span> @isbn = isbn</span><br><span class="line">    @price = Float(price)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">price=</span><span class="params">(new_price)</span></span></span><br><span class="line">    @price = new_price</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">book = BookInStock.new(<span class="string">"isbn1"</span>, <span class="number">33.80</span>)</span><br><span class="line">puts <span class="string">"ISBN = <span class="subst">#&#123;book.isbn&#125;</span>"</span> <span class="comment"># ISBN = isbn1</span></span><br><span class="line">puts <span class="string">"Price = <span class="subst">#&#123;book.price&#125;</span>"</span> <span class="comment"># Price = 33.8</span></span><br><span class="line">book.price = book.price * <span class="number">0</span>.<span class="number">75</span> <span class="comment"># 할인가격</span></span><br><span class="line">puts <span class="string">"New price = <span class="subst">#&#123;book.price&#125;</span>"</span> <span class="comment"># New price = 25.349999999999998</span></span><br></pre></td></tr></table></figure>
<p>setter 메서드는 위와 같은 형식으로 선언되어야 하는데, 값을 대입하는 메서드만 만들고 싶다면, attr_writer를 사용하면 된다, 하지만 이런 경우는 매우 드물기 때문에 인스턴스 변수의 값을 속성으로 읽는 것과 대입하는 것 모두를 한 번에 정의해주는 attr_accessor를 제공한다</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInStock</span></span></span><br><span class="line">  <span class="keyword">attr_reader</span> <span class="symbol">:isbn</span></span><br><span class="line">  <span class="keyword">attr_accessor</span> <span class="symbol">:price</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(isbn, price)</span></span></span><br><span class="line">    @isbn = isbn</span><br><span class="line">    @price = Float(price)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">book = BookInStock.new(<span class="string">"isbn1"</span>, <span class="number">33.80</span>)</span><br><span class="line">puts <span class="string">"ISBN = <span class="subst">#&#123;book.isbn&#125;</span>"</span> <span class="comment"># ISBN = isbn1</span></span><br><span class="line">puts <span class="string">"Price = <span class="subst">#&#123;book.price&#125;</span>"</span> <span class="comment"># Price = 33.8</span></span><br><span class="line">book.price = book.price * <span class="number">0</span>.<span class="number">75</span></span><br><span class="line">puts <span class="string">"New price = <span class="subst">#&#123;book.price&#125;</span>"</span> <span class="comment"># New price = 25.349999999999998</span></span><br></pre></td></tr></table></figure>
<p>속성과 관련한 메서드가 단순히 인스턴스 변수를 읽거나 대입만 하는 간단한 메서드일 필요는 없다</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInStock</span></span></span><br><span class="line">  <span class="keyword">attr_reader</span> <span class="symbol">:isbn</span></span><br><span class="line">  <span class="keyword">attr_accessor</span> <span class="symbol">:price</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(isbn, price)</span></span></span><br><span class="line">    @isbn = isbn</span><br><span class="line">    @price = Float(price)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">price_in_cents</span></span></span><br><span class="line">    Integer(price*<span class="number">100</span> + <span class="number">0</span>.<span class="number">5</span>) <span class="comment"># 0.5를 더한 뒤 정수로 변환하여 반올림된 실제 값에 가까운 정수를 얻기 위함</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">price_in_cents=</span><span class="params">(cents)</span></span></span><br><span class="line">    @price = cents / <span class="number">100.0</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">book = BookInStock.new(<span class="string">"isbn1"</span>, <span class="number">33.80</span>)</span><br><span class="line">puts <span class="string">"Price = <span class="subst">#&#123;book.price&#125;</span>"</span> <span class="comment"># Price = 33.8</span></span><br><span class="line">puts <span class="string">"Price in cents = <span class="subst">#&#123;book.price_in_cents&#125;</span>"</span> <span class="comment">#  Price in cents = 3380</span></span><br><span class="line">book.price_in_cents = <span class="number">1234</span></span><br><span class="line">puts <span class="string">"Price = <span class="subst">#&#123;book.price&#125;</span>"</span> <span class="comment"># Price = 12.34</span></span><br><span class="line">puts <span class="string">"Price in cents = <span class="subst">#&#123;book.price_in_cents&#125;</span>"</span> <span class="comment"># Price in cents = 1234</span></span><br></pre></td></tr></table></figure>
<p>price_in_cents는 객체 밖에서는 객체의 속성(attribute)로 보이지만, 내부적으로 저 속성에 대응하는 인스턴스 변수는 존재하지 않는다</p>
<p>인스턴스 변수와 계산된 값의 차이를 숨겨서, 클래스 구현에서 내부를 보호할 수 있는 방법을 제공할 수 있다, 이는 단일 접근 법칙과 관련이 있다</p>
<h4 id="속성-인스턴스-변수-메서드"><a href="#속성-인스턴스-변수-메서드" class="headerlink" title="속성, 인스턴스 변수, 메서드"></a>속성, 인스턴스 변수, 메서드</h4><p>속성과 메서드의 차이는 무엇인가?</p>
<p>속성은 단지 메서드일 뿐이다. 속성은 getter이기도, computed value를 반환하기도, 또는 setter의 역할을 하기도 한다, 어디까지가 속성이고 어디서부터가 일반 메서드인가? 속성을 일반 메서드와 구분 짓는 차이점은 무엇일까? 사실 적당히 취향대로 골라잡으면 되지만, 아래와 같이 생각해볼 수 있다</p>
<p>클래스를 설계할 때는 내부적으로 어떤 상태를 가지고, 이 상태를 외부(그 클래스의 사용자)에 어떤 모습으로 노출할지 결정해야 한다, 여기서 내부 상태는 인스턴스 변수에 저장한다, 외부에 보이는 상태는 속성(attribute)이라고 부르는 메서드를 통해야만 한다, 그 밖에 클래스가 할 수 있는 모든 행동은 일반 메서드를 통해야만 한다, 이런 구분법이 아주 중요한 것은 아니지만, 그래도 객체의 외부 상태를 속성이라고 부른다면 클래스를 사용하는 사람이 우리가 만든 클래스를 어떻게 봐야 하는지에 대한 힌트를 줄 수 있을 것이다</p>
<hr>
<h2 id="3-2-다른-클래스와-함께-사용하기"><a href="#3-2-다른-클래스와-함께-사용하기" class="headerlink" title="3.2 다른 클래스와 함께 사용하기"></a>3.2 다른 클래스와 함께 사용하기</h2><p>객체지향 설계에서는 외부의 대상을 파악하고 이를 코드를 통해 클래스로 만든다, 하지만 설계상에서 클래스의 대상이 되는 또 다른 대상이 있다, 이는 외부가 아닌 내부 코드 자체에 대응하는 클래스다</p>
<p>예를 들어 헌책방의 CSV 데이터를 읽어 들여 여러 가지 보고서를 만들어야 한다면, CSV 데이터를 읽어 들여 통계를 내고 요약해야 한다</p>
<p>어떻게 통계를 내고 요약할지에 따라서 설계 방향이 결정된다, 그리고 그 답은 CSV 리더에 있다 (각각의 CSV 데이터가 어떻게 생겼을지는 앞의 BookInStock에서 정의했다)</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># book_in_stock.rb</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInStock</span></span></span><br><span class="line">  <span class="keyword">attr_reader</span> <span class="symbol">:isbn</span>, <span class="symbol">:price</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(isbn, price)</span></span></span><br><span class="line">    @isbn = isbn</span><br><span class="line">    @price = Float(price)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># csv_reaedr.rb</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">'csv'</span></span><br><span class="line">require_relative <span class="string">'book_in_stock'</span> <span class="comment"># require_relative을 사용하는 것은 로드하려는 파일의 위치가 로드하는 파일을 기준으로 상대 위치에 있기 때문이다. 여기서 두 파일은 모두 같은 위치에 있다</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CsvReader</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span></span></span><br><span class="line">    @books_in_stock = []</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">read_in_csv_data</span><span class="params">(csv_file_name)</span></span></span><br><span class="line">    CSV.foreach(csv_file_name, <span class="symbol">headers:</span> <span class="literal">true</span>) <span class="keyword">do</span> <span class="params">|row|</span></span><br><span class="line">      @books_in_stock &lt;&lt; BookInStock.new(row[<span class="string">"ISBN"</span>], row[<span class="string">"Price"</span>])</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">total_value_in_stock</span></span></span><br><span class="line">    sum = <span class="number">0</span>.<span class="number">0</span></span><br><span class="line">    @books_in_stock.each &#123;<span class="params">|book|</span> sum += book.price&#125;</span><br><span class="line">    sum</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">number_of_each_isbn</span></span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># stock_stats.rb</span></span><br><span class="line">require_relative <span class="string">'csv_reader'</span></span><br><span class="line"></span><br><span class="line">reader = CsvReader.new ARGV.each <span class="keyword">do</span> <span class="params">|csv_file_name|</span></span><br><span class="line">  STDERR.puts <span class="string">"Processing <span class="subst">#&#123;csv_file_name&#125;</span>"</span></span><br><span class="line">  reader.read_in_csv_data(csv_file_name)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">puts <span class="string">"Total value = <span class="subst">#&#123;reader.total_value_in_stock&#125;</span>"</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="3-3-접근-제어"><a href="#3-3-접근-제어" class="headerlink" title="3.3 접근 제어"></a>3.3 접근 제어</h2><p>클래스 인터페이스를 설계할 때, 클래스를 외부에 어느 정도까지 노출할지 결정하는 것은 중요한 일이다</p>
<p>클래스에 너무 깊이 접근하도록 허용하면 각 요소 간의 결합도가 높아질 우려가 있다, 다시 말해 이 클래스의 사용자 코드는 클래스 내부 구현의 세세한 부분에까지 종속적이 되기 쉽다는 것이다</p>
<p>루비에서 객체 상태를 변경하는 방법은 메서드를 호출하는 것일 뿐이므로 메서드에 대한 접근을 적절히 설정하면 객체에 대한 접근을 제어할 수 있다, 경험적으로 볼 때 객체의 상태를 망가뜨릴 수 있는 메서드는 노출해서는 안 된다</p>
<p>루비의 세 가지 보호 단계는 다음과 같다</p>
<ul>
<li>public : 접근 제어가 없음, 메서드는 기본적으로 public (단, initialize는 예외적으로 항상 private)</li>
<li>protected : 이 메서드는 그 객체를 정의한 클래스와 하위 클래스에서만 호출할 수 있다</li>
<li>private : 메서드는 수신자를 지정해서 호출할 수 없다, 오직 현재 객체에서만 호출 가능</li>
</ul>
<ul>
<li style="list-style: none"><input type="checkbox"> 루비는 접근 제어가 동적으로 결정된다, 따라서 접근 위반 예외는 제한된 메서드를 실제로 호출한 그 때에만 발생한다</li>
</ul>
<h3 id="접근-제어-기술하기"><a href="#접근-제어-기술하기" class="headerlink" title="접근 제어 기술하기"></a>접근 제어 기술하기</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Account</span></span></span><br><span class="line">  <span class="keyword">attr_accessor</span> <span class="symbol">:balance</span></span><br><span class="line">    </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(balance)</span></span></span><br><span class="line">    @balance = balance</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Transaction</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(account_a, account_b)</span></span></span><br><span class="line">    @account_a = account_a</span><br><span class="line">    @account_b = account_b</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">transfer</span><span class="params">(amount)</span></span></span><br><span class="line">    debit(@account_a, amount)</span><br><span class="line">    credit(@account_b, amount)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">  private</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">debit</span><span class="params">(account, amount)</span></span></span><br><span class="line">    account.balance -= amount</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">credit</span><span class="params">(account, amount)</span></span></span><br><span class="line">    account.balance += amount</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">savings = Account.new(<span class="number">100</span>)</span><br><span class="line">checking = Account.new(<span class="number">200</span>)</span><br><span class="line">trans = Transaction.new(checking, savings)</span><br><span class="line">trans.transfer(<span class="number">50</span>)</span><br></pre></td></tr></table></figure>
<p>protected 접근은 객체가 같은 클래스에서 생성된 다른 객체의 상태에 접근할 필요가 있을 때 사용한다. 예를 들어 각각의 Account 객체의 결산 잔액을 비교 하고 싶은데, 잔액 자체는 (아마 다른 형식으로 보여주고자 하기 때문에) 외부에 보여주고 싶지는 않은 경우를 보자.</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Account</span></span></span><br><span class="line">  <span class="keyword">attr_reader</span> <span class="symbol">:cleared_balance</span> <span class="comment"># 접근자 메서드 'cleared_balance'를 만든다.</span></span><br><span class="line">  protected <span class="symbol">:cleared_balance</span> <span class="comment"># 접근자 메서드를 protected 메서드로 설정한다.</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">greater_balance_than?</span><span class="params">(other)</span></span></span><br><span class="line">    @cleared_balance &gt; other.cleared_balance</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="3-4-변수"><a href="#3-4-변수" class="headerlink" title="3.4 변수"></a>3.4 변수</h2><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">person = <span class="string">"Tim"</span></span><br><span class="line">puts <span class="string">"The object in 'person' is a <span class="subst">#&#123;person.<span class="keyword">class</span>&#125;</span>"</span> <span class="comment"># The object in 'person' is a String</span></span><br><span class="line">puts <span class="string">"The object has an id of <span class="subst">#&#123;person.object_id&#125;</span>"</span> <span class="comment"># The object has an id of 70264079641280</span></span><br><span class="line">puts <span class="string">"and a value of '<span class="subst">#&#123;person&#125;</span>'"</span> <span class="comment"># and a value of 'Tim'</span></span><br></pre></td></tr></table></figure>
<p>변수는 객체가 아니라 객체에 대한 참조를 가지고 있을 뿐이다, 힙 메모리에 있는 객체를 변수가 가리키고 있다</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">person1 = <span class="string">"Tim"</span></span><br><span class="line">person2 = person1</span><br><span class="line">person1[<span class="number">0</span>] = <span class="string">'J'</span></span><br><span class="line">puts <span class="string">"person1 is <span class="subst">#&#123;person1&#125;</span>"</span> <span class="comment"># person1 is Jim</span></span><br><span class="line">puts <span class="string">"person2 is <span class="subst">#&#123;person2&#125;</span>"</span> <span class="comment"># person2 is Jim</span></span><br></pre></td></tr></table></figure>
<p>person2에 person1을 대입해도 새로운 객체는 생성되지 않으며, 단지 person1 객체에 대한 참조를 person2에 복사해서 같은 객체를 참조하도록 만들 뿐이다</p>
<p>대입은 객체의 별명을 늘려서 결과적으로 여러 개의 변수가 하나의 객체를 참조하도록 한다</p>
<p>dup 메서드를 사용한다면 같은 내용을 담은 객체를 새로 생성한다</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">person1 = <span class="string">"Tim"</span></span><br><span class="line">person2 = person1.dup person1[<span class="number">0</span>] = <span class="string">"J"</span></span><br><span class="line">puts <span class="string">"person1 is <span class="subst">#&#123;person1&#125;</span>"</span> <span class="comment"># person1 is Jim</span></span><br><span class="line">puts <span class="string">"person2 is <span class="subst">#&#123;person2&#125;</span>"</span> <span class="comment"># person2 is Tim</span></span><br></pre></td></tr></table></figure>
<p>객체를 동결해서 객체의 상태를 변경할 수 없도록 할 수도 있다, 동결된 객체를 수정하려고 하면 루비는 RuntimeError 예외를 발생시킨다</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">person1 = <span class="string">"Tim"</span></span><br><span class="line">person2 = person1</span><br><span class="line">person1.freeze <span class="comment"># 객체 수정을 막는다.</span></span><br><span class="line">person2[<span class="number">0</span>] = <span class="string">"J"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 실행 결과:</span></span><br><span class="line"><span class="comment"># from prog.rb:4:in `&lt;main&gt;'</span></span><br><span class="line"><span class="comment"># prog.rb:4:in `[]=': can't modify frozen String (RuntimeError)</span></span><br></pre></td></tr></table></figure>
<p>클래스 메서드, 믹스인, 상속 등의 개념은 </p>
</div><div class="article__tags"><a class="article__tags__item" href="/tags/Ruby/">Ruby</a></div><div class="article__author" itemscope itemprop="author" itemtype="https://schema.org/Person"><img class="article__author__image" src="/images/avatar.jpg" alt="Jeewhan"><a class="article__author__link" title="About Jeewhan" rel="author">Jeewhan</a><p class="article__author__desc">Dev Blog</p><div class="article__author__socials"><a class="article__author__socials__item" href="/atom.xml" title="rss" target="_blank"><i class="fa fa-rss"></i></a></div><meta itemprop="name" content="Jeewhan"></div><div class="sharer" id="sharer"><div class="sharer-inner"><div class="sharer__right"><button class="sharer__item" id="sharer-facebook"><i class="fa fa-facebook-official"></i></button><button class="sharer__item" id="sharer-twitter"><i class="fa fa-twitter"></i></button><button class="sharer__item" id="sharer-pinterest"><i class="fa fa-pinterest"></i></button><button class="sharer__item" id="sharer-pocket"><i class="fa fa-get-pocket"></i></button></div></div></div><!-- Disqus Code--><!-- Meta Tags for Structured Data--><meta itemprop="dateModified" content="2018-06-02T01:11:48.775Z"><meta itemprop="articleBody" content="루비에서 다루는 모든 것은 객체이며, 클래스에서 직간접적으로 생성할 수 있다, 이번 장에서는 클래스를 만들고 다루는 법을 살펴본다
객체지향 시스템을 설계할 때 항상 제일 먼저 해야 하는 일은 다루고자 하는 대상들의 특징을 파악하는 것이다일반적으로 다루고자 하는 대상들이 속하는 형식(type)은 클래스로 만들어진다, 그리고 각 대상은 이 클래스의..."><meta itemprop="url" content="https://eclatant.io/2018/05/27/Ruby-Pickaxe-chapter3/"><meta itemprop="mainEntityOfPage" content="https://eclatant.io/2018/05/27/Ruby-Pickaxe-chapter3/"><div itemscope itemtype="https://schema.org/Organization" itemprop="publisher"><meta itemprop="name" content="The Pragmatic Programmer"><div itemscope itemprop="logo" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://eclatant.io/images/hollywood.png"></div></div><div itemscope itemtype="https://schema.org/ImageObject" itemprop="image"><meta itemprop="contentUrl" content="https://eclatant.io/images/hollywood.jpg"><meta itemprop="url" content="https://eclatant.io/images/hollywood.jpg"><meta itemprop="width" content="800"><meta itemprop="height" content="800"></div></article><section class="related-posts"><h3>Related posts</h3><div class="related-posts__item__wrapper"><a class="related-posts__item" href="/2018/05/13/Ruby-Pickaxe-chapter2/"><div class="related-posts__item__background" style="background-image:url('/images/hollywood.jpg');"></div><div class="related-posts__item__overlay"></div><span class="related-posts__item__title">루비 곡괭이 2장 Ruby.new</span></a></div><div class="related-posts__item__wrapper"><a class="related-posts__item" href="/2018/05/06/Ruby-Intro2/"><div class="related-posts__item__background" style="background-image:url('/images/hollywood.jpg');"></div><div class="related-posts__item__overlay"></div><span class="related-posts__item__title">루비 기초</span></a></div></section></div></div></div><footer id="footer"><div class="widgets"><div class="widgets-inner"><!-- Jade doesn't support dynamic inclusion with `each`.--><!-- So, I just hard coded the file names that will be included.--><div class="widgets__item"><h3 class="widgets__item__heading">Recent posts</h3><ul class="recent-posts"><li class="recent-posts__item"><a href="/2018/11/26/2018-11-26-MoidaFE-0/">Moida-FE #0 : 18-11-26</a></li><li class="recent-posts__item"><a href="/2018/11/25/2018-11-25-SearchHistory/">이번 주에 검색했던 것들 #2 : 18-11-25</a></li><li class="recent-posts__item"><a href="/2018/11/18/2018-11-18-SearchHistory/">이번 주에 검색했던 것들 #1 : 18-11-18</a></li><li class="recent-posts__item"><a href="/2018/11/11/2018-11-11-Start/">글쓰기 시작</a></li><li class="recent-posts__item"><a href="/2018/11/11/2018-11-11-SearchHistory/">이번 주에 검색했던 것들 #0 : 18-11-11</a></li></ul></div><div class="widgets__item"><h3 class="widgets__item__heading">Tag cloud</h3><div class="tag-cloud"><a href="/tags/Algorithm/" style="font-size: 1.25rem;">Algorithm</a> <a href="/tags/Article/" style="font-size: 0.75rem;">Article</a> <a href="/tags/CtCI/" style="font-size: 1rem;">CtCI</a> <a href="/tags/Dev/" style="font-size: 1.5rem;">Dev</a> <a href="/tags/English/" style="font-size: 0.75rem;">English</a> <a href="/tags/Essay/" style="font-size: 1rem;">Essay</a> <a href="/tags/FP/" style="font-size: 0.75rem;">FP</a> <a href="/tags/JS/" style="font-size: 0.75rem;">JS</a> <a href="/tags/Python/" style="font-size: 0.75rem;">Python</a> <a href="/tags/Rails/" style="font-size: 0.75rem;">Rails</a> <a href="/tags/React/" style="font-size: 1rem;">React</a> <a href="/tags/Ruby/" style="font-size: 1.25rem;">Ruby</a> <a href="/tags/TDD/" style="font-size: 0.75rem;">TDD</a> <a href="/tags/node/" style="font-size: 0.75rem;">node</a></div></div><div class="widgets__item"><h3 class="widgets__item__heading">Categories</h3><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Algorithm/">Algorithm</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Article/">Article</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/CodeSquad/">CodeSquad</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/CtCI/">CtCI</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Dev/">Dev</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/English/">English</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Essay/">Essay</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JS/">JS</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Rails/">Rails</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/React/">React</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Ruby/">Ruby</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/node/">node</a><span class="category-list-count">1</span></li></ul></div></div></div><p class="copyright"><small>© 2018 Jeewhan<br>Powered by <a href="https://hexo.io" rel="external" target="_blank">Hexo</a>, Theme by <a href="https://github.com/hyunseob" rel="external" target="_blank">HyunSeob</a></small></p></footer><!--[if lt IE 10]><script src="/js/classList.min.js"></script><![endif]--><script src="/js/index.min.js"></script></body></html>